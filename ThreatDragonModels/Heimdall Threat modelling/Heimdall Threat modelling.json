{
  "summary": {
    "title": "Heimdall Threat modelling",
    "owner": "GoLive Boys"
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "title": "Threat modelling",
        "thumbnail": "./public/content/images/thumbnail.jpg",
        "id": 0,
        "diagramJson": {
          "cells": [
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 746,
                "y": 228
              },
              "angle": 0,
              "id": "4994546d-ad2e-4ef0-8542-ab1dd3358ea5",
              "z": 1,
              "hasOpenThreats": true,
              "threats": [
                {
                  "ruleId": "b2a6d40d-d3f8-4750-8e4d-c02cc84b13dc",
                  "title": "Generic spoofing threat",
                  "type": "Spoofing",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "A generic spoofing threat",
                  "mitigation": "Authentication"
                },
                {
                  "ruleId": "4adaa48a-0345-4533-a189-64c98c4420dd",
                  "title": "Generic tampering threat",
                  "type": "Tampering",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "A generic tampering threat",
                  "mitigation": "Authentication"
                },
                {
                  "ruleId": "87bc37e2-798e-4d68-bb96-feb1da26da48",
                  "title": "Generic repudiation threat",
                  "type": "Repudiation",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "A generic repudiation threat",
                  "mitigation": "Audit Log"
                },
                {
                  "ruleId": "13000296-b17d-4b72-9cc4-f5cc33f80e4c",
                  "title": "Generic information disclosure threat",
                  "type": "Information disclosure",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "A generic information disclosure threat",
                  "mitigation": "Authentication"
                },
                {
                  "ruleId": "edb05d76-a695-455f-947b-7d67b78bc31d",
                  "title": "Generic DoS threat",
                  "type": "Denial of service",
                  "status": "Open",
                  "severity": "Low",
                  "description": "Token Api might have problems here because of crypto calculations"
                },
                {
                  "ruleId": "c1377855-ea20-4c97-8861-f95c364fb8d2",
                  "title": "Generic elevation threat",
                  "type": "Elevation of privilege",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "Nowhere to elevate to",
                  "mitigation": ""
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "Heimdall"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 47,
                "y": 380
              },
              "angle": 0,
              "id": "dfd560ba-a22f-46c7-9412-c80207358f06",
              "z": 2,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "CMS"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 379,
                "y": 123
              },
              "angle": 0,
              "id": "0036cda3-55c3-44e8-aac8-1deac0d208a2",
              "z": 3,
              "hasOpenThreats": false,
              "outOfScope": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "James"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 118,
                "y": 182
              },
              "angle": 0,
              "id": "c59e4cfc-ab05-4241-b8db-56db18ff10be",
              "z": 4,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "WFM"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Actor",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 651,
                "y": 1
              },
              "angle": 0,
              "id": "0ee2a531-6bf0-4ede-a5b9-08ba2adddf95",
              "z": 5,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "App"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 416,
                "y": 327
              },
              "angle": 0,
              "id": "ad0d66e6-dc8a-4534-87ae-53e1b8bfd83d",
              "z": 6,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "LOL"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 356,
                "y": 486
              },
              "angle": 0,
              "id": "699dd9bb-5d3b-490a-8c99-dee0431094b5",
              "z": 8,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "DB"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0036cda3-55c3-44e8-aac8-1deac0d208a2"
              },
              "target": {
                "id": "0ee2a531-6bf0-4ede-a5b9-08ba2adddf95"
              },
              "vertices": [],
              "id": "3685d4a5-ac56-4aa9-8f57-1209a1f7a2e4",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 10",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 11,
              "hasOpenThreats": false,
              "isPublicNetwork": true,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "ad0d66e6-dc8a-4534-87ae-53e1b8bfd83d"
              },
              "target": {
                "id": "4994546d-ad2e-4ef0-8542-ab1dd3358ea5"
              },
              "vertices": [],
              "id": "b6fcb339-71db-4e85-9df0-012865676b67",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 11",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 12,
              "hasOpenThreats": true,
              "threats": [
                {
                  "ruleId": "4adaa48a-0345-4533-a189-64c98c4420dd",
                  "title": "Generic tampering threat",
                  "type": "Tampering",
                  "status": "Open",
                  "severity": "Low",
                  "description": "If communication goes via load balancer, tampering is more realistic. Otherwise it's communication in same subnet and VPC",
                  "mitigation": "Authentication"
                },
                {
                  "ruleId": "13000296-b17d-4b72-9cc4-f5cc33f80e4c",
                  "title": "Generic information disclosure threat",
                  "type": "Information disclosure",
                  "status": "Open",
                  "severity": "Low",
                  "description": "If communication goes via load balancer this can be an issue, otherwise it's the same subnet"
                },
                {
                  "ruleId": "edb05d76-a695-455f-947b-7d67b78bc31d",
                  "title": "Generic DoS threat",
                  "type": "Denial of service",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "",
                  "mitigation": "Same subnet"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "ad0d66e6-dc8a-4534-87ae-53e1b8bfd83d"
              },
              "target": {
                "id": "c59e4cfc-ab05-4241-b8db-56db18ff10be"
              },
              "vertices": [
                {
                  "x": 264,
                  "y": 324
                }
              ],
              "id": "04966594-2b49-4065-8f15-8fe232cd2ca3",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 12",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 13,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "ad0d66e6-dc8a-4534-87ae-53e1b8bfd83d"
              },
              "target": {
                "id": "dfd560ba-a22f-46c7-9412-c80207358f06"
              },
              "vertices": [],
              "id": "8f379ab9-cda6-4aca-8e67-0740c041ea63",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 13",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 14,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "dfd560ba-a22f-46c7-9412-c80207358f06"
              },
              "target": {
                "id": "c59e4cfc-ab05-4241-b8db-56db18ff10be"
              },
              "vertices": [],
              "id": "f4054f1d-784f-467d-8c43-65c6d4c541de",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 14",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 15,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "c59e4cfc-ab05-4241-b8db-56db18ff10be"
              },
              "target": {
                "id": "0036cda3-55c3-44e8-aac8-1deac0d208a2"
              },
              "vertices": [],
              "id": "85850b0c-a94c-479e-85b8-6c2917b84113",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 15",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 16,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 1,
                "y": 46
              },
              "angle": 0,
              "id": "1754e3ac-0340-46df-b62a-354d4960ef64",
              "z": 17,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "Contego"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 537,
                "y": 59
              },
              "target": {
                "x": 653,
                "y": 109
              },
              "vertices": [
                {
                  "x": 580,
                  "y": 53
                }
              ],
              "id": "4b04ee0c-ca4c-40fa-99cd-969a2eb794ca",
              "z": 18,
              "attrs": {}
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "4994546d-ad2e-4ef0-8542-ab1dd3358ea5"
              },
              "target": {
                "id": "0036cda3-55c3-44e8-aac8-1deac0d208a2"
              },
              "vertices": [
                {
                  "x": 689,
                  "y": 210
                }
              ],
              "id": "2fdcece3-47b8-4401-b91b-b17485df7396",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 18",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 19,
              "hasOpenThreats": true,
              "protocol": "",
              "isEncrypted": true,
              "isPublicNetwork": true,
              "threats": [
                {
                  "ruleId": "4adaa48a-0345-4533-a189-64c98c4420dd",
                  "title": "Generic tampering threat",
                  "type": "Tampering",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "A generic tampering threat",
                  "mitigation": "Authentication\nIP whitelisting ??\nHTTPS"
                },
                {
                  "ruleId": "13000296-b17d-4b72-9cc4-f5cc33f80e4c",
                  "title": "Generic information disclosure threat",
                  "type": "Information disclosure",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "A generic information disclosure threat",
                  "mitigation": "HTTPS\nAuthentication"
                },
                {
                  "ruleId": "edb05d76-a695-455f-947b-7d67b78bc31d",
                  "title": "Generic DoS threat",
                  "type": "Denial of service",
                  "status": "Open",
                  "severity": "Medium",
                  "description": "If you spam login on james, it could lead to issues in Heimdall because of crypto operations",
                  "mitigation": "Ip-whitelisting"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "1754e3ac-0340-46df-b62a-354d4960ef64"
              },
              "target": {
                "id": "0036cda3-55c3-44e8-aac8-1deac0d208a2"
              },
              "vertices": [],
              "id": "5ffa1aa8-a971-4482-9c71-c80c6c7a683a",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 19",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 20,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "699dd9bb-5d3b-490a-8c99-dee0431094b5"
              },
              "target": {
                "id": "ad0d66e6-dc8a-4534-87ae-53e1b8bfd83d"
              },
              "vertices": [],
              "id": "7b380c81-bb4a-4fc8-b72e-3c866475023a",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 19",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 21,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 296,
                "y": 48
              },
              "target": {
                "x": 636,
                "y": 156
              },
              "vertices": [
                {
                  "x": 426,
                  "y": 291
                }
              ],
              "id": "5a9a8bb0-3818-4195-a59c-f3ac64a18d1b",
              "z": 22,
              "attrs": {}
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0036cda3-55c3-44e8-aac8-1deac0d208a2"
              },
              "target": {
                "id": "ad0d66e6-dc8a-4534-87ae-53e1b8bfd83d"
              },
              "vertices": [],
              "id": "d6faf7de-b1fd-4001-a2cb-0efa39b2d0b7",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 21",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 23,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "4994546d-ad2e-4ef0-8542-ab1dd3358ea5"
              },
              "target": {
                "id": "699dd9bb-5d3b-490a-8c99-dee0431094b5"
              },
              "vertices": [
                {
                  "x": 761,
                  "y": 452
                }
              ],
              "id": "6670ad5f-6529-48e8-b2bf-853a903a9027",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 20",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 24,
              "hasOpenThreats": true,
              "threats": [
                {
                  "ruleId": "4adaa48a-0345-4533-a189-64c98c4420dd",
                  "title": "Generic tampering threat",
                  "type": "Tampering",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "A generic tampering threat",
                  "mitigation": "Same VPC."
                },
                {
                  "ruleId": "13000296-b17d-4b72-9cc4-f5cc33f80e4c",
                  "title": "Generic information disclosure threat",
                  "type": "Information disclosure",
                  "status": "Open",
                  "severity": "Medium",
                  "description": "Need to check how we deal with users against the DB. Should not be able to get LOL stuff with same user as heimdall schema user"
                },
                {
                  "ruleId": "edb05d76-a695-455f-947b-7d67b78bc31d",
                  "title": "Generic DoS threat",
                  "type": "Denial of service",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "",
                  "mitigation": "Private subnet"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "dfd560ba-a22f-46c7-9412-c80207358f06"
              },
              "target": {
                "id": "699dd9bb-5d3b-490a-8c99-dee0431094b5"
              },
              "vertices": [],
              "id": "60f24e2d-35b5-4398-bcad-7ee4730cc21d",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 21",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 25,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Actor",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 954,
                "y": 8
              },
              "angle": 0,
              "id": "0d719282-be0e-428f-be89-6c54ebf67216",
              "z": 26,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "SMS"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "0d719282-be0e-428f-be89-6c54ebf67216"
              },
              "target": {
                "id": "4994546d-ad2e-4ef0-8542-ab1dd3358ea5"
              },
              "vertices": [],
              "id": "8d086e19-2cfb-46bd-8ac4-ce4eee2b43fd",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "flow 23",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 27,
              "hasOpenThreats": true,
              "isEncrypted": true,
              "isPublicNetwork": true,
              "threats": [
                {
                  "ruleId": "4adaa48a-0345-4533-a189-64c98c4420dd",
                  "title": "Generic tampering threat",
                  "type": "Tampering",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "A generic tampering threat",
                  "mitigation": "Authentication"
                },
                {
                  "ruleId": "13000296-b17d-4b72-9cc4-f5cc33f80e4c",
                  "title": "Generic information disclosure threat",
                  "type": "Information disclosure",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "A generic information disclosure threat",
                  "mitigation": "Authentication"
                },
                {
                  "ruleId": "edb05d76-a695-455f-947b-7d67b78bc31d",
                  "title": "Generic DoS threat",
                  "type": "Denial of service",
                  "status": "Open",
                  "severity": "Low",
                  "description": "A generic DoS threat",
                  "mitigation": ""
                },
                {
                  "ruleId": "4adaa48a-0345-4533-a189-64c98c4420dd",
                  "title": "Repudiation threat",
                  "type": "Repudiation",
                  "status": "Mitigated",
                  "severity": "Medium",
                  "description": "Repudiation",
                  "mitigation": "Audit Logs"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 1025,
                "y": 164
              },
              "target": {
                "x": 862,
                "y": 129
              },
              "vertices": [
                {
                  "x": 940,
                  "y": 177
                }
              ],
              "id": "91a15f4d-1393-4163-9800-234858e0a9ac",
              "z": 28,
              "attrs": {}
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 264,
                "y": 76
              },
              "target": {
                "x": 121,
                "y": 162
              },
              "vertices": [],
              "id": "e089230d-69ae-4112-8692-59a3d7cee97b",
              "z": 29,
              "attrs": {}
            }
          ]
        },
        "size": {
          "height": 606,
          "width": 2181.119873046875
        }
      }
    ]
  }
}